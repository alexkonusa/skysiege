Work in progress at building my own script based on this one.